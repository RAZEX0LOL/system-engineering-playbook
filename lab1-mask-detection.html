<!DOCTYPE HTML>
<html lang="ru" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Лабораторная работа №1: Система контроля СИЗ (Mask Detection) - Руководство по системной инженерии</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="src/_assets/custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "navy";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Руководство по системной инженерии</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="Лабораторная-работа-1-Система-контроля-средств-индивидуальной-защиты"><a class="header" href="#Лабораторная-работа-1-Система-контроля-средств-индивидуальной-защиты">Лабораторная работа №1: Система контроля средств индивидуальной защиты</a></h1>
<h2 id="Оглавление"><a class="header" href="#Оглавление">Оглавление</a></h2>
<ul>
<li><a href="#%D0%B2%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5">Введение</a></li>
<li><a href="#%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B8-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B">Задачи системы</a></li>
<li><a href="#%D1%86%D0%B5%D0%BB%D0%B5%D0%B2%D0%B0%D1%8F-%D0%B0%D1%83%D0%B4%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D1%8F-%D0%B8-%D0%BE%D0%B1%D0%BB%D0%B0%D1%81%D1%82%D0%B8-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F">Целевая аудитория и области применения</a></li>
<li><a href="#%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-%D1%81%D1%82%D1%8D%D0%BA">Технологический стэк</a></li>
<li><a href="#%D1%82%D1%80%D0%B5%D0%B1%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B-%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8F-%D1%81%D0%B8%D0%B7-%D0%B8-%D0%B8%D1%85-%D0%B2%D0%BB%D0%B8%D1%8F%D0%BD%D0%B8%D0%B5-%D0%BD%D0%B0-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D1%83">Требования системы контроля СИЗ и их влияние на архитектуру</a></li>
<li><a href="#%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0-%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D0%BD%D0%BD%D0%BE%D0%B9-%D1%81%D0%B5%D1%82%D0%B8">Архитектура нейронной сети</a></li>
<li><a href="#%D0%B8%D1%81%D1%82%D0%BE%D1%87%D0%BD%D0%B8%D0%BA%D0%B8">Источники</a></li>
</ul>
<hr />
<h2 id="Введение"><a class="header" href="#Введение">Введение</a></h2>
<p>Данная документация описывает систему для автоматического мониторинга использования средств индивидуальной защиты органов дыхания в реальном времени с помощью алгоритмов компьютерного зрения.</p>
<hr />
<h2 id="Задачи-системы"><a class="header" href="#Задачи-системы">Задачи системы</a></h2>
<ul>
<li><strong>Захват видеопотока в реальном времени</strong> с веб-камеры, установленной в контролируемой зоне</li>
<li><strong>Детекция антропометрических объектов (лиц)</strong> в каждом кадре видео</li>
<li><strong>Классификация каждого обнаруженного лица</strong> по признаку наличия или отсутствия маски</li>
<li><strong>Визуализация результатов:</strong>
<ul>
<li>Обрамление лица <strong>зеленым прямоугольником</strong> при наличии маски</li>
<li>Обрамление лица <strong>красным прямоугольником</strong> при отсутствии маски</li>
</ul>
</li>
</ul>
<hr />
<h2 id="Целевая-аудитория-и-области-применения"><a class="header" href="#Целевая-аудитория-и-области-применения">Целевая аудитория и области применения</a></h2>
<h3 id="Производственные-предприятия"><a class="header" href="#Производственные-предприятия">Производственные предприятия</a></h3>
<p><em>(химические, металлургические, деревообрабатывающие)</em></p>
<ul>
<li><strong>Проблема:</strong> Работники пренебрегают масками в цехах с запыленностью или испарениями</li>
<li><strong>Решение:</strong> Установка камеры на входе в опасную зону. Система в реальном времени предупреждает мастеров о нарушителях</li>
</ul>
<h3 id="Строительные-компании"><a class="header" href="#Строительные-компании">Строительные компании</a></h3>
<ul>
<li><strong>Проблема:</strong> Рабочие не используют респираторы при работе с пылью, краской</li>
<li><strong>Решение:</strong> Мониторинг на ключевых объектах стройплощадки для превентивного выявления нарушений</li>
</ul>
<h3 id="Медицинские-учреждения"><a class="header" href="#Медицинские-учреждения">Медицинские учреждения</a></h3>
<p><em>(особенно стационары и лаборатории)</em></p>
<ul>
<li><strong>Проблема:</strong> Соблюдение масочного режима для профилактики внутрибольничных инфекций</li>
<li><strong>Решение:</strong> Контроль в холлах, коридорах и общих зонах для снижения рисков</li>
</ul>
<hr />
<h2 id="Технологический-стэк"><a class="header" href="#Технологический-стэк">Технологический стэк</a></h2>
<blockquote>
<p><strong>⚠️ ТРЕБУЕТСЯ ДОПОЛНЕНИЕ:</strong> Текущий список технологий неполный</p>
</blockquote>
<h3 id="Основной-язык"><a class="header" href="#Основной-язык">Основной язык</a></h3>
<ul>
<li><strong>Python</strong> — язык программирования для всех компонентов системы</li>
</ul>
<h3 id="Библиотеки-и-фреймворки"><a class="header" href="#Библиотеки-и-фреймворки">Библиотеки и фреймворки</a></h3>
<blockquote>
<p><strong>🔴 ДОПОЛНИТЬ:</strong> В исходной документации указан только Python. На основе анализа кода необходимо добавить:</p>
</blockquote>
<ul>
<li>
<p><strong>TensorFlow/Keras</strong> — фреймворк для работы с нейронными сетями</p>
<ul>
<li>Версия: ≥ 2.0.0</li>
<li>Использование: загрузка и инференс модели MobileNetV2</li>
</ul>
</li>
<li>
<p><strong>OpenCV (opencv-python)</strong> — библиотека компьютерного зрения</p>
<ul>
<li>Версия: ≥ 4.2.0</li>
<li>Использование: захват видеопотока, обработка изображений, детекция лиц</li>
</ul>
</li>
<li>
<p><strong>NumPy</strong> — библиотека для работы с массивами</p>
<ul>
<li>Версия: ≥ 1.18.0</li>
<li>Использование: обработка тензоров изображений</li>
</ul>
</li>
<li>
<p><strong>imutils</strong> — утилиты для обработки видео</p>
<ul>
<li>Версия: ≥ 0.5.3</li>
<li>Использование: VideoStream для захвата видео, resize изображений</li>
</ul>
</li>
<li>
<p><strong>Tkinter</strong> — библиотека для создания GUI</p>
<ul>
<li>Использование: графический интерфейс приложения</li>
</ul>
</li>
<li>
<p><strong>PIL (Pillow)</strong> — библиотека для работы с изображениями</p>
<ul>
<li>Использование: конвертация кадров для отображения в GUI</li>
</ul>
</li>
</ul>
<h3 id="Модели-машинного-обучения"><a class="header" href="#Модели-машинного-обучения">Модели машинного обучения</a></h3>
<ul>
<li>
<p><strong>MobileNetV2</strong> (предобученная на ImageNet)</p>
<ul>
<li>Файл модели: <code>mask_detector.keras</code></li>
</ul>
</li>
<li>
<p><strong>Caffe SSD</strong> для детекции лиц</p>
<ul>
<li>Prototxt: <code>face_detector/deploy.prototxt</code></li>
<li>Веса: <code>face_detector/res10_300x300_ssd_iter_140000.caffemodel</code></li>
</ul>
</li>
</ul>
<h3 id="Отличительные-особенности-и-преимущества"><a class="header" href="#Отличительные-особенности-и-преимущества">Отличительные особенности и преимущества</a></h3>
<ul>
<li><strong>Работа в реальном времени:</strong> Низкая задержка обработки</li>
<li><strong>Автоматизация:</strong> Исключение человеческого фактора из процесса контроля</li>
<li><strong>Наглядность:</strong> Цветовая индикация позволяет мгновенно оценить обстановку</li>
<li><strong>Простота внедрения:</strong> Для работы требуется стандартная веб-камера и ПК</li>
<li><strong>Масштабируемость:</strong> Архитектура позволяет в будущем дообучить модель на другие виды СИЗ (каски, защитные очки)</li>
</ul>
<hr />
<h2 id="Требования-системы-контроля-СИЗ-и-их-влияние-на-архитектуру"><a class="header" href="#Требования-системы-контроля-СИЗ-и-их-влияние-на-архитектуру">Требования системы контроля СИЗ и их влияние на архитектуру</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Требование системы</th><th>Влияние на архитектуру</th><th>Реализация в выбранной модели</th></tr></thead><tbody>
<tr><td>Работа в реальном времени</td><td>Низкая задержка, высокая скорость инференса</td><td>MobileNetV2 оптимизирована для быстрого выполнения</td></tr>
<tr><td>Работа на доступном оборудовании</td><td>Низкие вычислительные требования, малый объем памяти</td><td>Облегченная архитектура Depthwise Separable Convolutions</td></tr>
<tr><td>Высокая точность распознавания</td><td>Способность извлекать сложные признаки</td><td>Transfer Learning с моделью, обученной на ImageNet</td></tr>
<tr><td>Устойчивость к изменениям условий</td><td>Робастность к освещению, ракурсам, частичным перекрытиям</td><td>Аугментация данных и мощный feature extractor</td></tr>
<tr><td>Ограниченный датасет для обучения</td><td>Эффективное обучение на небольшом количестве данных</td><td>Техника Transfer Learning</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="Архитектура-нейронной-сети"><a class="header" href="#Архитектура-нейронной-сети">Архитектура нейронной сети</a></h2>
<h3 id="Общая-концепция-transfer-learning-Трансферное-обучение"><a class="header" href="#Общая-концепция-transfer-learning-Трансферное-обучение">Общая концепция: Transfer Learning (Трансферное обучение)</a></h3>
<p>Система использует технику трансферного обучения — подход, при котором предварительно обученная на большом датасете (ImageNet) модель адаптируется для решения конкретной задачи. Это позволяет достичь высокой точности даже при ограниченном количестве обучающих данных.</p>
<h3 id="Описание-архитектуры"><a class="header" href="#Описание-архитектуры">Описание архитектуры</a></h3>
<p><strong>Параметры обучения:</strong></p>
<ul>
<li><strong>Базовая модель:</strong> MobileNetV2 с предобученными весами ImageNet</li>
<li><strong>Входные данные:</strong> Изображения 224×224×3 RGB</li>
<li><strong>Аугментация данных:</strong> ImageDataGenerator с трансформациями</li>
<li><strong>Оптимизатор:</strong> Adam с learning rate = 0.0001</li>
<li><strong>Функция потерь:</strong> Binary Crossentropy</li>
</ul>
<blockquote>
<p><strong>🔴 ТРЕБУЕТСЯ ДОПОЛНЕНИЕ:</strong> Информация о датасете для обучения</p>
</blockquote>
<blockquote>
<p><strong>⚠️ ДОПОЛНИТЬ:</strong></p>
<ul>
<li>Название и источник датасета</li>
<li>Количество изображений в обучающей/валидационной выборках</li>
<li>Распределение классов (Mask/No Mask)</li>
<li>Параметры аугментации (rotation_range, zoom_range, etc.)</li>
</ul>
</blockquote>
<h3 id="Двухкомпонентная-архитектура"><a class="header" href="#Двухкомпонентная-архитектура">Двухкомпонентная архитектура</a></h3>
<h4 id="1-Базовая-модель-base-model---mobilenetv2"><a class="header" href="#1-Базовая-модель-base-model---mobilenetv2">1. Базовая модель (Base Model) - MobileNetV2</a></h4>
<pre><code class="language-python">baseModel = MobileNetV2(weights="imagenet", include_top=False,
                        input_tensor=Input(shape=(224, 224, 3)))
</code></pre>
<p><strong>Характеристики:</strong></p>
<ul>
<li><strong>Архитектура:</strong> MobileNetV2 — современная сверточная, оптимизированная нейронная сеть</li>
<li><strong>Входные данные:</strong> Изображения размером 224×224×3 (RGB)</li>
<li><strong>Веса:</strong> Предобучена на датасете ImageNet (1.2 млн изображений, 1000 классов)</li>
<li><strong>Включение верхних слоев:</strong> <code>include_top=False</code> — исключает финальные классификационные слои</li>
</ul>
<p><strong>Преимущества выбора MobileNetV2:</strong></p>
<ul>
<li>Высокая эффективность при небольшом количестве параметров</li>
<li>Быстрая обработка в реальном времени</li>
<li>Оптимизирована для embedded-систем и мобильных устройств</li>
</ul>
<h4 id="2-Головная-модель-head-model---Пользовательский-классификатор"><a class="header" href="#2-Головная-модель-head-model---Пользовательский-классификатор">2. Головная модель (Head Model) - Пользовательский классификатор</a></h4>
<pre><code class="language-python">headModel = baseModel.output
headModel = AveragePooling2D(pool_size=(7, 7))(headModel)
headModel = Flatten(name="flatten")(headModel)
headModel = Dense(128, activation="relu")(headModel)
headModel = Dropout(0.5)(headModel)
headModel = Dense(2, activation="softmax")(headModel)
</code></pre>
<p><strong>Слои головной модели:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Слой</th><th>Параметры</th><th>Назначение</th></tr></thead><tbody>
<tr><td>AveragePooling2D</td><td>pool_size=(7, 7)</td><td>Усреднение карт признаков для уменьшения размерности</td></tr>
<tr><td>Flatten</td><td>-</td><td>Преобразование 2D-данных в 1D-вектор</td></tr>
<tr><td>Dense</td><td>128 нейронов, ReLU</td><td>Полносвязный слой для обучения специфичным признакам</td></tr>
<tr><td>Dropout</td><td>rate=0.5</td><td>Регуляризация - исключение 50% нейронов для предотвращения переобучения</td></tr>
<tr><td>Dense</td><td>2 нейрона, Softmax</td><td>Финальный классификационный слой</td></tr>
</tbody></table>
</div>
<p>Данная архитектура обеспечивает баланс между точностью классификации и производительностью, что критически важно для систем реального времени.</p>
<p><strong>Преимущества для проекта СИЗ:</strong></p>
<ul>
<li>Обучение за часы, а не недели</li>
<li>Высокая точность даже на 2-5 тысячах изображений</li>
<li>Устойчивость к различным условиям съемки</li>
<li>Возможность легкого переобучения на другие признаки</li>
</ul>
<h3 id="Обоснование-структуры-головного-классификатора"><a class="header" href="#Обоснование-структуры-головного-классификатора">Обоснование структуры головного классификатора</a></h3>
<pre><code class="language-python">headModel = AveragePooling2D(pool_size=(7, 7))(headModel)  # Уменьшение размерности
headModel = Flatten()(headModel)
headModel = Dense(128, activation="relu")(headModel)       # Достаточная емкость для 2 классов
headModel = Dropout(0.5)(headModel)                        # Борьба с переобучением
headModel = Dense(2, activation="softmax")(headModel)      # Бинарная классификация
</code></pre>
<p><strong>Почему такая структура оптимальна:</strong></p>
<ul>
<li><strong>128 нейронов</strong> — золотая середина: достаточно для сложных признаков, но не избыточно</li>
<li><strong>Dropout 0.5</strong> — эффективная регуляризация для предотвращения запоминания датасета</li>
<li><strong>Softmax</strong> — идеален для взаимоисключающих классов ("маска есть" / "маски нет")</li>
</ul>
<hr />
<h2 id="Система-детекции-лиц"><a class="header" href="#Система-детекции-лиц">Система детекции лиц</a></h2>
<blockquote>
<p><strong>🔴 ТРЕБУЕТСЯ ДОПОЛНЕНИЕ:</strong> Детальное описание метода детекции лиц</p>
</blockquote>
<h3 id="Используемая-модель"><a class="header" href="#Используемая-модель">Используемая модель</a></h3>
<p>В проекте используется <strong>Caffe-based SSD (Single Shot Detector)</strong> с бэкбоном ResNet-10 для детекции лиц:</p>
<ul>
<li><strong>Prototxt:</strong> <code>face_detector/deploy.prototxt</code> — архитектура сети</li>
<li><strong>Модель:</strong> <code>face_detector/res10_300x300_ssd_iter_140000.caffemodel</code> — обученные веса</li>
</ul>
<h3 id="Параметры-детекции"><a class="header" href="#Параметры-детекции">Параметры детекции</a></h3>
<pre><code class="language-python">prototxtPath = r"face_detector\deploy.prototxt"
weightsPath = r"face_detector\res10_300x300_ssd_iter_140000.caffemodel"
faceNet = cv2.dnn.readNet(prototxtPath, weightsPath)
</code></pre>
<p><strong>Процесс детекции:</strong></p>
<ol>
<li>Создание blob из кадра с размером 224×224</li>
<li>Подача blob в сеть детекции лиц</li>
<li>Фильтрация детекций с confidence &gt; 0.5</li>
<li>Извлечение координат ограничивающих рамок (bounding boxes)</li>
<li>Предобработка лиц для классификации масок</li>
</ol>
<hr />
<h2 id="Графический-интерфейс-пользователя"><a class="header" href="#Графический-интерфейс-пользователя">Графический интерфейс пользователя</a></h2>
<blockquote>
<p><strong>🔴 ТРЕБУЕТСЯ ДОПОЛНЕНИЕ:</strong> Описание GUI компонента отсутствовало в исходной документации</p>
</blockquote>
<p>Система включает полнофункциональный графический интерфейс на базе <strong>Tkinter</strong>:</p>
<h3 id="Основные-компоненты-интерфейса"><a class="header" href="#Основные-компоненты-интерфейса">Основные компоненты интерфейса</a></h3>
<ol>
<li>
<p><strong>Окно видеопотока</strong></p>
<ul>
<li>Отображение в реальном времени с наложенными детекциями</li>
<li>Цветовая индикация (зеленый/красный бокс)</li>
<li>Отображение процента уверенности модели</li>
</ul>
</li>
<li>
<p><strong>Панель управления</strong></p>
<ul>
<li>Кнопка "Запуск" — начало детекции</li>
<li>Кнопка "Остановка" — пауза системы</li>
<li>Кнопка "Выход" — закрытие приложения</li>
</ul>
</li>
<li>
<p><strong>Строка состояния</strong></p>
<ul>
<li>Отображение текущего статуса системы</li>
<li>Подсчет обнаруженных лиц в кадре</li>
<li>Уведомления об ошибках</li>
</ul>
</li>
</ol>
<h3 id="Основной-класс-приложения"><a class="header" href="#Основной-класс-приложения">Основной класс приложения</a></h3>
<pre><code class="language-python">class MaskDetectionApp:
    def __init__(self, root):
        self.root = root
        self.root.title("Mask Detection System")
        self.root.geometry("1000x700")

        self.vs = None
        self.current_frame = None
        self.is_running = False

        self.create_widgets()
        self.load_models()
</code></pre>
<hr />
<h2 id="Производительность-системы"><a class="header" href="#Производительность-системы">Производительность системы</a></h2>
<blockquote>
<p><strong>🔴 КРИТИЧЕСКОЕ ДОПОЛНЕНИЕ:</strong> Отсутствуют метрики производительности обученной модели</p>
</blockquote>
<blockquote>
<p><strong>⚠️ НЕОБХОДИМО ДОБАВИТЬ:</strong></p>
<ul>
<li>Accuracy (точность) на тестовой выборке</li>
<li>Precision (точность положительных предсказаний)</li>
<li>Recall (полнота)</li>
<li>F1-score</li>
<li>Confusion Matrix</li>
<li>Время обработки одного кадра (FPS)</li>
<li>Результаты на различных условиях освещения</li>
<li>Примеры ошибочных классификаций и их анализ</li>
</ul>
</blockquote>
<hr />
<h2 id="Сравнение-с-альтернативными-архитектурами"><a class="header" href="#Сравнение-с-альтернативными-архитектурами">Сравнение с альтернативными архитектурами</a></h2>
<p>Для системы автоматического контроля средств индивидуальной защиты (СИЗ) требуется архитектура, обеспечивающая оптимальный баланс между точностью, скоростью работы и эффективностью на edge-устройствах. Проведем анализ современных архитектур на основе актуальных научных исследований.</p>
<h3 id="1-mobilenetv2---текущий-выбор"><a class="header" href="#1-mobilenetv2---текущий-выбор">1. MobileNetV2 - текущий выбор</a></h3>
<p><strong>Архитектурное описание:</strong></p>
<p>MobileNetV2 представляет собой сверточную нейронную сеть, основанную на архитектуре с инвертированными остаточными блоками (inverted residuals) и линейными бутылочными горлышками (linear bottlenecks). Ключевые особенности архитектуры включают использование depthwise separable convolutions для снижения вычислительной сложности, а также механизм расширения и сжатия каналов в остаточных блоках. Сеть оптимизирована для работы на мобильных и edge-устройствах при сохранении конкурентной точности.</p>
<p><strong>Преимущества для задачи детекции СИЗ:</strong></p>
<ul>
<li>
<p><strong>Проверенная эффективность в реальных системах мониторинга</strong>
Согласно исследованию 2025 года, архитектура MobileNetV2 в связке с SSD демонстрирует высокую эффективность для задач автоматизированного мониторинга, достигая показателя точности 87.4% mAP. Это подтверждает пригодность архитектуры для развертывания в реальных системах с ограниченными вычислительными ресурсами, что характерно для систем контроля СИЗ [1].</p>
</li>
<li>
<p><strong>Высокая точность в требовательных приложениях</strong>
В исследовании 2024 года модифицированная архитектура MobileNetV2 показала точность 97.73% при классификации медицинских изображений, что доказывает ее способность решать сложные задачи визуального распознавания даже в таких критически важных областях, как медицинская диагностика [2].</p>
</li>
<li>
<p><strong>Эффективность работы с ограниченными данными</strong>
Исследование 2025 года подтверждает исключительную эффективность MobileNetV2 при работе с небольшими наборами данных. Архитектура позволяет достигать точности 98.6% в задачах тонкой классификации, что особенно важно для систем распознавания СИЗ, где сбор больших размеченных datasets часто затруднен [3].</p>
</li>
<li>
<p><strong>Оптимизация производительности</strong>
Тот же источник [3] отмечает, что оптимизированные реализации MobileNetV2 позволяют сократить время обучения на 50-70% и время вывода на 10% по сравнению с базовой версией, что обеспечивает экономическую эффективность и практическую применимость системы.</p>
</li>
<li>
<p><strong>Подтвержденная надежность архитектуры</strong>
Современные научные работы 2024-2025 годов продолжают активно использовать MobileNetV2 в прикладных решениях для edge-устройств, что свидетельствует о сохранении актуальности и надежности данной архитектуры для промышленного применения [1,2,3].</p>
</li>
</ul>
<h3 id="2-mobilenetv3-large"><a class="header" href="#2-mobilenetv3-large">2. MobileNetV3 Large</a></h3>
<p><strong>Архитектурное описание:</strong></p>
<p>MobileNetV3 Large представляет собой крупномасштабную версию архитектуры MobileNetV3, разработанную с применением нейроархитектурного поиска (NAS). Модель сохраняет базовые принципы MobileNetV2, включая inverted residuals и linear bottlenecks, но дополнена squeeze-and-excitation блоками и оптимизированными активационными функциями h-swish. Архитектура ориентирована на достижение максимальной точности при сохранении приемлемой производительности на мобильных устройствах.</p>
<h3 id="3-mobilenetv3-small"><a class="header" href="#3-mobilenetv3-small">3. MobileNetV3 Small</a></h3>
<p><strong>Архитектурное описание:</strong></p>
<p>MobileNetV3 Small является компактной версией архитектуры, оптимизированной для максимального быстродействия и минимального потребления ресурсов. Как и в Large-версии, здесь применяется нейроархитектурный поиск и те же основные структурные элементы, но с уменьшенной шириной сети и оптимизированной конфигурацией блоков. Модель предназначена для приложений с экстремальными ограничениями по вычислительным ресурсам и энергопотреблению.</p>
<h3 id="4-efficientnet"><a class="header" href="#4-efficientnet">4. EfficientNet</a></h3>
<p><strong>Архитектурное описание:</strong></p>
<p>EfficientNet использует инновационный подход составного масштабирования (compound scaling), равномерно увеличивая глубину, ширину и разрешение входных данных. Архитектура основана на mobile inverted bottleneck convolution (MBConv) — технике, также используемой в MobileNetV2. Систематический подход к масштабированию позволяет достигать высокой точности при оптимальном использовании вычислительных ресурсов, однако требует тщательной настройки гиперпараметров.</p>
<h3 id="5-vision-transformers"><a class="header" href="#5-vision-transformers">5. Vision Transformers</a></h3>
<p><strong>Архитектурное описание:</strong></p>
<p>Vision Transformers адаптируют архитектуру трансформеров, изначально разработанную для обработки естественного языка, к задачам компьютерного зрения. Основной принцип заключается в разбиении изображения на патчи и обработке их как последовательности данных с помощью механизмов внимания. Архитектура обеспечивает глобальный контекст изображения, но предъявляет высокие требования к вычислительным ресурсам и объему тренировочных данных, что ограничивает ее применение в edge-устройствах.</p>
<h3 id="Таблица-сравнения-архитектур"><a class="header" href="#Таблица-сравнения-архитектур">Таблица сравнения архитектур</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Архитектура</th><th>Ключевой принцип / Структура</th><th>Показатели эффективности (ImageNet)</th><th>Основные преимущества</th><th>Вывод для системы контроля СИЗ</th></tr></thead><tbody>
<tr><td><strong>MobileNetV2</strong></td><td>Inverted Residuals с Linear Bottlenecks. Основной блок: слой расширения (pointwise conv), depthwise convolution, слой проекции (pointwise conv, линейная активация). Остаточные связи между bottleneck-слоями.</td><td>Точность Top-1: 71.3%<br>Точность Top-5: 90.1% [5]<br>Параметры: 3.5 млн [5]<br>Время вывода: 25.9 мс [5]</td><td>Проверенная надежность, низкие требования к ресурсам. Эффективное использование параметров, оптимизирована для мобильных устройств.</td><td>✅ <strong>Оптимальный выбор.</strong> Сочетает достаточную точность с возможностью работы в реальном времени на edge-устройствах.</td></tr>
<tr><td><strong>MobileNetV3 Large</strong></td><td>Сочетание NAS (Hardware-Aware NAS) и NetAdapt алгоритма с наследием V1/V2. Добавлены Squeeze-and-Excitation блоки и h-swish активация в глубоких слоях.</td><td>Точность Top-1: 75.6% [4]<br>Параметры: 5.4 млн [4]<br>Время вывода: 51.2 мс [4]</td><td>Улучшенная точность классификации, аппаратная оптимизация благодаря автоматизированному поиску архитектуры.</td><td>Альтернатива для задач с повышенными требованиями к точности. Увеличенное время вывода может быть критично для систем реального времени.</td></tr>
<tr><td><strong>MobileNetV3 Small</strong></td><td>Сочетание NAS (Hardware-Aware NAS) и NetAdapt алгоритма с наследием V1/V2. Добавлены Squeeze-and-Excitation блоки и h-swish активация в глубоких слоях.</td><td>Точность Top-1: 68.1% [4]<br>Параметры: 2.9 млн [4]<br>Время вывода: 15.8 мс [4]</td><td>Максимальная скорость работы, минимальные требования к ресурсам.</td><td>Решение для систем с экстремальными ограничениями по вычислительным ресурсам. Сниженная точность может быть недостаточной для надежного контроля СИЗ.</td></tr>
<tr><td><strong>EfficientNet</strong></td><td>Compound Scaling: сбалансированное масштабирование глубины, ширины и разрешения изображения.</td><td>Точность Top-1: 77.1% (B0)<br>Точность Top-1: 84.4% (B7)<br>Параметры: ~5.3 млн (B0)</td><td>Системное масштабирование, высокая точность классификации.</td><td>Специализированное решение. Избыточен для большинства задач контроля СИЗ, требует больше ресурсов.</td></tr>
<tr><td><strong>Vision Transformer</strong></td><td>Разбиение изображения на патчи, обработка последовательности патчей энкодером Transformer со self-attention.</td><td>Точность: Сопоставима с лучшими CNN-моделями [6]<br>Параметры: Модели могут быть очень большими, например, ViT-Huge содержит 632 млн параметров [7]</td><td>Глобальный контекст изображения, перспективная архитектура.</td><td>Экспериментальная технология. Непрактична для реальных систем из-за высоких требований к данным и вычислителям.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="Заключение"><a class="header" href="#Заключение">Заключение</a></h2>
<p>Для системы автоматического контроля СИЗ архитектура <strong>MobileNetV2</strong> демонстрирует наилучший баланс между:</p>
<ul>
<li>Точностью обнаружения</li>
<li>Скоростью работы в реальном времени</li>
<li>Эффективностью использования ресурсов</li>
</ul>
<p>Это подтверждается успешным применением в аналогичных промышленных системах мониторинга.</p>
<p>Альтернативные архитектуры предлагают незначительные улучшения отдельных метрик, но не обеспечивают комплексного превосходства для задачи детекции СИЗ в реальных условиях.</p>
<hr />
<h2 id="Источники"><a class="header" href="#Источники">Источники</a></h2>
<ol>
<li>
<p>Amoako E. et al. Application of SSD-MobileNetV2 for automated defect detection in masonry bridges using AI and IoT // Advances in Bridge Engineering. – 2025. – Т. 6. – №. 1. – С. 31.</p>
</li>
<li>
<p>Zhou G. et al. Optimizing MobileNetV2 for improved accuracy in early gastric cancer detection based on dynamic pelican optimizer // Heliyon. – 2024. – Т. 10. – №. 16.</p>
</li>
<li>
<p>Martins O. O., Oosthuizen C. C., Desai D. A. Evaluating unified training optimisations for MobileNetV2: Efficiency-accuracy trade-offs in fine-grained dog breed classification // Discover Applied Sciences. – 2025. – Т. 7. – №. 11. – С. 1240.</p>
</li>
<li>
<p>Keras: MobileNet and MobileNetV2 [Электронный ресурс]. – URL: https://keras.io/api/applications/mobilenet/ (дата обращения: 15.10.2025).</p>
</li>
<li>
<p>Keras: Applications API [Электронный ресурс]. – URL: https://keras.io/api/applications/ (дата обращения: 15.10.2025).</p>
</li>
<li>
<p>Nauen T. C. et al. Which Transformer to Favor: A Comparative Analysis of Efficiency in Vision Transformers // 2025 IEEE/CVF Winter Conference on Applications of Computer Vision (WACV). – IEEE, 2025. – С. 6955-6966.</p>
</li>
<li>
<p>Saha S., Xu L. Vision transformers on the edge: A comprehensive survey of model compression and acceleration strategies // Neurocomputing. – 2025. – С. 130417.</p>
</li>
</ol>
<hr />
<h2 id="Приложение-Структура-проекта"><a class="header" href="#Приложение-Структура-проекта">Приложение: Структура проекта</a></h2>
<pre><code>mask_detector/
├── detect_mask_video.py          # Основной скрипт приложения
├── mask_detector.keras            # Обученная модель классификации
├── requirements.txt               # Зависимости проекта
└── face_detector/
    ├── deploy.prototxt           # Архитектура Caffe SSD
    └── res10_300x300_ssd_iter_140000.caffemodel  # Веса модели детекции лиц
</code></pre>
<hr />
<blockquote>
<p><strong>📋 СВОДКА НЕОБХОДИМЫХ ДОПОЛНЕНИЙ:</strong></p>
<ol>
<li><strong>Технологический стэк</strong> — добавлены все недостающие библиотеки ✅</li>
<li><strong>Датасет для обучения</strong> — требуется описание используемого датасета 🔴</li>
<li><strong>Параметры аугментации</strong> — требуется уточнение 🔴</li>
<li><strong>Система детекции лиц</strong> — добавлено описание Caffe SSD ✅</li>
<li><strong>Графический интерфейс</strong> — добавлено полное описание GUI ✅</li>
<li><strong>Метрики производительности</strong> — критически важное дополнение 🔴</li>
<li><strong>Структура проекта</strong> — добавлена схема файлов ✅</li>
</ol>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="md.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="md.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
